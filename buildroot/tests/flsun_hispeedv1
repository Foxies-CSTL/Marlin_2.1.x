#!/usr/bin/env bash
#
# Build tests for MKS Robin nano
# (STM32F1 genericSTM32F103VE)
#

# exit on first failure
set -e

#
# Flsun HiSpeedv1 based QQSPro
#
use_example_configs Flsun Deltas
opt_set MOTHERBOARD BOARD_FLSUN_HISPEED SERIAL_PORT 3 SERIAL_PORT_2 1 NUM_SERIAL 2 \
        TEMP_SENSOR_0 1 TEMP_SENSOR_BED 1 \
        DELTA DELTA_PRINTABLE_RADIUS 130.0 DELTA_DIAGONAL_ROD 280.0 DELTA_HEIGHT 370.00 DELTA_RADIUS 140.8 \
        GRID_MAX_POINTS_X 8 \
        NOZZLE_TO_PROBE_OFFSET '{ 0, 0, 16.2 }' \
opt_enable MKS_ROBIN_TFT32 \
        FILAMENT_WIDTH_SENSOR SOUND_MENU_ITEM \
        AUTO_BED_LEVELING_UBL PREHEAT_BEFORE_LEVELING Z_MIN_PROBE_REPEATABILITY_TEST DEBUG_LEVELING_FEATURE \
        BABYSTEPPING BABYSTEP_XY BABYSTEP_ZPROBE_OFFSET \
        PRINTCOUNTER NOZZLE_PARK_FEATURE PIDTEMPBED EEPROM_SETTINGS \
        ADVANCED_PAUSE_FEATURE PARK_HEAD_ON_PAUSE \
        HOST_KEEPALIVE_FEATURE HOST_ACTION_COMMANDS HOST_PROMPT_SUPPORT \
        LCD_INFO_MENU ARC_SUPPORT AUTO_REPORT_TEMPERATURES \
        SDSUPPORT EMERGENCY_PARSER    
exec_test $1 $2 "Flsun QQSP Stock" "$3"

#
# Flsun HiSpeed v1 Emulated DOGM FSMC
#

#restore_configs
#opt_set MOTHERBOARD BOARD_FLSUN_HISPEED SERIAL_PORT_2 1 \
#        NEOPIXEL_TYPE NEO_RGB


#
# Flsun HiSpeed v1  LVGL FSMC
#
#use_example_configs Flsun Deltas
#opt_set MOTHERBOARD BOARD_FLSUN_HISPEED
#opt_disable TFT_CLASSIC_UI TFT_COLOR_UI TOUCH_SCREEN TFT_ROBIN_TFT35
#opt_enable TFT_LVGL_UI TFT_RES_480x320
#exec_test $1 $2 "Flsun HiSpeed v1 LVGL FSMC" "$3"


#
# Flsun HiSpeed v1  LVGL FSMC + TMC2209
#
#use_example_configs Flsun Deltas
#opt_set MOTHERBOARD BOARD_FLSUN_HISPEED X_DRIVER_TYPE TMC2209 Y_DRIVER_TYPE TMC2209 Z_DRIVER_TYPE TMC2209
#opt_enable TFT_INTERFACE_FSMC TFT_COLOR_UI TOUCH_SCREEN TFT_ROBIN_TFT35
#exec_test $1 $2 "FLsun HiSpeed v1 FSMC + TMC" "$3"

# cleanup
restore_configs
